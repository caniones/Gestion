unit uABMlineas;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, uABMbase, DB, StdCtrls, Buttons, ExtCtrls, Grids, DBGrids;

type
  TfrmABMlineas = class(TfrmABMbase)
    procedure FormCreate(Sender: TObject);
    procedure btnAltaClick(Sender: TObject);
    procedure btnModiClick(Sender: TObject);
    procedure btnBajaClick(Sender: TObject);
    procedure dbgDatosDblClick(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  frmABMlineas: TfrmABMlineas;

implementation

uses uAMlinea, udmLineas;

var
  dm:TdmLineas;

{$R *.dfm}

procedure TfrmABMlineas.FormCreate(Sender: TObject);
begin
  inherited;
  dm:=TdmLineas.Create(self);
end;

procedure TfrmABMlineas.btnAltaClick(Sender: TObject);
var
  FInput:TfrmImputLinea;
begin
  inherited;
  FInput:=TfrmImputLinea.Create(self);
  try
    dsDatos.DataSet.Insert;
    if FInput.ShowModal = mrOK then
      if dm.validar then
        application.MessageBox('El nombre ya se encuentra en la lista',
        'Atención',MB_ICONINFORMATION)
      else
        dm.grabar;
    dsDatos.DataSet.Cancel;
  finally
    FInput.Free;
  end;
end;

procedure TfrmABMlineas.btnModiClick(Sender: TObject);
var
  FInput:TfrmImputLinea;
begin
  inherited;
  FInput:=TfrmImputLinea.Create(self);
  try
    dsDatos.DataSet.Edit;
    if FInput.ShowModal = mrOK then
      if dm.validar then
        application.MessageBox('El nombre ya se encuentra en la lista',
        'Atención',MB_ICONINFORMATION)
      else
        dm.grabar;
    dsDatos.DataSet.Cancel;
  finally
    FInput.Free;
  end;
end;

procedure TfrmABMlineas.btnBajaClick(Sender: TObject);
begin
  inherited;
  If application.MessageBox('¿Desea eliminar la Línea?  '+#13+#13,
    'Atención',MB_YESNO + MB_ICONWARNING) = 6 Then
    if dm.permisoBaja then
      begin
      dsDatos.DataSet.Delete;
      dm.grabar;
      end
    else
      application.MessageBox('La Línea que desea borrar posee Artículos'+#13+#13+
      'Primero borre los Artículos','Atención',MB_ICONINFORMATION);
end;

procedure TfrmABMlineas.dbgDatosDblClick(Sender: TObject);
begin
  inherited;
  btnModi.Click;
end;

end.
